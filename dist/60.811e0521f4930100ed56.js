"use strict";(self.webpackChunkrm_frontend=self.webpackChunkrm_frontend||[]).push([[60],{1848:function(t,e,r){r.r(e);var o=r(311),s=r(320),i=r(446),n=r(724),a=r(322),h=r(447),p=function(t){if(s.Z.bindAll(this),s.Z.extend(this,t),!RM.common.magCreationInProgress)if(this.analytics=this.router&&this.router.analytics,this.router?this.router==RM.viewerRouter?this.routerName="viewer":this.router==RM.collectorRouter?this.routerName="collector":this.router==RM.constructorRouter?this.routerName="constructor":this.routerName="unknown":this.routerName="error",this.analytics&&!this.noCreateRequestTracking&&this.analytics.sendEvent("Create Mag Request"),a.Z.isDesktop)if(Modernizr.msie||Modernizr.msie11)this.showIEPopupWarning();else if(this.me){var e="function"==typeof this.me.get?this.me.get("permissions"):this.me.permissions;this.skipPermissionsCheck||e&&e.can_create_mag?this.innerCreateMag():this.showCreatePopupWarning()}else this.showJoinForm();else this.showMobilePopupWarning()};p.prototype.innerCreateMag=function(){var t={};this.analytics&&this.analytics.sendEvent("Create Mag"),this.currentFolderId&&(t.folder=this.currentFolderId),this.sharedUser&&(t.user=this.sharedUser),RM.common.magCreationInProgress=!0,o.ZP.ajax({url:i.ZP.readymag_auth_host+(this.templateID?"/api/magFromTemplate/"+this.templateID:"/api/mag/"),type:"POST",data:t,success:s.Z.bind((function(t){"function"==typeof this.success&&this.success(),RM.common.magCreationInProgress=!1,window.location.href=i.ZP.readymag_auth_host+"/edit/"+t.num_id+"/contents/"}),this),error:s.Z.bind((function(){if("function"==typeof this.error&&this.error(),RM.common.magCreationInProgress=!1,console.log(arguments),alert("Creating project problem. Contact tech support, please: "+i.ZP.SUPPORT_MAIL),this.me){var t="function"==typeof this.me.get?this.me.get("uri"):this.me.uri;t&&(window.location.href=i.ZP.readymag_auth_host+"/"+t)}}),this)})},p.prototype.showCreatePopupWarning=function(){n.Z&&new n.Z({$parent:(0,o.ZP)("body > .popups"),router:this.router,opts:{type:"type-create"},alert_source:"create mag"}).render()},p.prototype.showMobilePopupWarning=function(){n.Z&&new n.Z({$parent:(0,o.ZP)("body > .popups"),router:this.router,opts:{type:"type-switch-desktop-create"},alert_source:"create mag mobile"}).render()},p.prototype.showIEPopupWarning=function(){n.Z&&new n.Z({$parent:(0,o.ZP)("body > .popups"),router:this.router,opts:{type:"type-browsers"}}).render()},p.prototype.showJoinForm=function(){h.Z.saveJoinData(),window.location.href="".concat(i.ZP.readymag_host,"/auth/join").concat(this.templateID?"?template="+this.templateID:"")},e.default=p}}]);